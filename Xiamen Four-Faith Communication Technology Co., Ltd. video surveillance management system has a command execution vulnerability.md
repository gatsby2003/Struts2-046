Xiamen Four-Faith Communication Technology Co., Ltd. video surveillance management system has S2-046 command execution vulnerability, which can further upload jsp Trojan getshell

**Vulnerability type: Struts2-046 command execution**
**Affected versions: V2016-V2017**
**Affected products: video surveillance management system**
**Official website of the company:** http://www.four-faith.com/html/solution/
![](https://cdn.nlark.com/yuque/0/2023/png/36030634/1700139274137-80bd748d-b760-4f3f-a6a3-14e740429d9b.png#averageHue=%23b3994e&id=kuJPM&originHeight=981&originWidth=1808&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)
Case reproduction
Hunter Syntax
web.icon=="71f6cf4eb8f020615cc27a32e5a4131d"&&web.title="视频监控"

Case 1: Access [http://139.196.140.244:9280/](http://139.196.140.244:9280/)
Confirmed as Xiamen Four-Faith Communication Technology Co., Ltd. video surveillance management system
![](https://cdn.nlark.com/yuque/0/2023/png/36030634/1700139274585-4cee2dea-6437-46ce-8e50-b2a2d71ac98c.png#averageHue=%2376b464&id=gbeTc&originHeight=958&originWidth=1751&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)
The S2-046 command execution vulnerability is confirmed, and the whoami system command is successfully executed, exposing the root path of the web service
![](https://cdn.nlark.com/yuque/0/2023/png/36030634/1700139275005-3f5ac24c-898a-4530-b5c1-4368d5930147.png#averageHue=%23ebe019&id=BeLJO&originHeight=923&originWidth=1296&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)
![](https://cdn.nlark.com/yuque/0/2023/png/36030634/1700139275407-b6b14e04-1fbc-49f9-bd0d-2afae1c75537.png#averageHue=%23e1c83b&id=iFjkp&originHeight=1016&originWidth=1386&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)
Upload the verification file temp1.jsp to the specified directory: 
 E:\\SP\\apache-tomcat-7.0.62\\webapps\\ROOT\\temp1.jsp

When putting the current path detected by Strust2-046 into it, be careful to separate the directory with a double slash, otherwise the upload may fail due to escaping
![](https://cdn.nlark.com/yuque/0/2023/png/36030634/1700139275815-a559e592-5543-4dec-8401-d2e054cc4431.png#averageHue=%23d4aa68&id=NfOg9&originHeight=973&originWidth=1330&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)
Access [http://139.196.140.244:9280/temp1.jsp](http://139.196.140.244:9280/temp1.jsp)  

temp1.jsp was successfully parsed by the server, and the echo whoami instruction and the return file root path code were executed successfully
![](https://cdn.nlark.com/yuque/0/2023/png/36030634/1700139276173-9f77505c-2c1c-42e1-af0a-39988318543b.png#averageHue=%231d1d1d&id=cDubY&originHeight=682&originWidth=1616&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)
Case 2: Access  [http://119.3.144.210:9280/](http://119.3.144.210:9280/)

Confirmed as Xiamen Four-Faith Communication Technology Co., Ltd. video surveillance management system
![](https://cdn.nlark.com/yuque/0/2023/png/36030634/1700139276518-d55ee348-8bdf-43c6-bb2d-a3f8002aef7b.png#averageHue=%232780dd&id=EZQFp&originHeight=891&originWidth=1409&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)
The S2-046 command execution vulnerability is confirmed, and the whoami system command is successfully executed, exposing the root path of the web service
![](https://cdn.nlark.com/yuque/0/2023/png/36030634/1700139277090-964ed501-c9a2-4943-94ce-5869520059a9.png#averageHue=%23f8f5eb&id=PEBCn&originHeight=961&originWidth=1056&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)
Upload the verification file temp1.jsp to the specified directory: 
E:\\DVR2.2\\apache-tomcat-8.5.32-web-9280\\webapps\\ROOT\\temp1.jsp

When putting the current path detected by Strust2-046 into it, be careful to separate the directory with a double slash, otherwise the upload may fail due to escaping
![](https://cdn.nlark.com/yuque/0/2023/png/36030634/1700139277503-b04e9543-761e-427e-bec1-79692adf11d0.png#averageHue=%23d3a968&id=yiRe9&originHeight=961&originWidth=1262&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)

Access [http://119.3.144.210:9280/temp1.jsp](http://119.3.144.210:9280/temp1.jsp)

temp1.jsp was successfully parsed by the server, and the echo whoami instruction and the return file root path code were executed successfully
![](https://cdn.nlark.com/yuque/0/2023/png/36030634/1700139277798-42394e79-5398-4a2f-beba-5e6512ccef0e.png#averageHue=%23232323&id=dswDM&originHeight=798&originWidth=1362&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)
Case 3: Access [http://58.20.63.203:9280/](http://58.20.63.203:9280/)

Confirmed as Xiamen Four-Faith Communication Technology Co., Ltd. video surveillance management system
![](https://cdn.nlark.com/yuque/0/2023/png/36030634/1700139278083-cb506a35-67e9-4f24-b10d-cacd496c1ead.png#averageHue=%2371b168&id=CvcuP&originHeight=1010&originWidth=1646&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)
The S2-046 command execution vulnerability is confirmed, and the whoami system command is successfully executed, exposing the root path of the web service
![](https://cdn.nlark.com/yuque/0/2023/png/36030634/1700139278529-a07998a9-dcee-4b5b-a749-afd06dae8113.png#averageHue=%23f8f6ec&id=tpmaK&originHeight=983&originWidth=1122&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)
Upload the verification file temp1.jsp to the specified directory: 
D:\\xmsx\\apache-tomcat-7.0.82-DVR\\webapps\\ROOT\\temp1.jsp

When putting the current path detected by Strust2-046 into it, be careful to separate the directory with a double slash, otherwise the upload may fail due to escaping
![](https://cdn.nlark.com/yuque/0/2023/png/36030634/1700139278926-2c8b806f-e83f-4e76-9e29-3a755414d07c.png#averageHue=%23d4aa69&id=xVteI&originHeight=970&originWidth=1364&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)
Access [http://58.20.63.203:9280/temp1.jsp](http://58.20.63.203:9280/temp1.jsp)

temp1.jsp was successfully parsed by the server, and the echo whoami instruction and the return file root path code were executed successfully
![](https://cdn.nlark.com/yuque/0/2023/png/36030634/1700139279256-53d6b4ec-3a04-4c39-8f0f-e1c06eedf68e.png#averageHue=%23262626&id=NXjvY&originHeight=743&originWidth=1271&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)
Other Cases (All Verified Successful)

4. [http://www.qj.sncoda.com:9280/](http://www.qj.sncoda.com:9280/)
![](https://cdn.nlark.com/yuque/0/2023/png/36030634/1700139279522-f2f688ff-3da5-406a-889a-f7b47f816409.png#averageHue=%23f8f6ed&id=imA85&originHeight=969&originWidth=1105&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)
5. [http://202.98.201.103:9280/](http://202.98.201.103:9280/)
![](https://cdn.nlark.com/yuque/0/2023/png/36030634/1700139279943-1e384a9b-0834-4db6-ab59-7860bd67ffbf.png#averageHue=%23f8f6ed&id=QrXUY&originHeight=959&originWidth=1189&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)
6. [http://140.210.212.47:9280/](http://140.210.212.47:9280/)
![](https://cdn.nlark.com/yuque/0/2023/png/36030634/1700139280370-eec5a521-4d02-45bf-85b2-95f8482003c3.png#averageHue=%23f7f5ea&id=Cxmw0&originHeight=988&originWidth=998&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)
7. [http://182.92.221.197:9000/](http://182.92.221.197:9000/)
![](https://cdn.nlark.com/yuque/0/2023/png/36030634/1700139280732-7d0ca2fb-d8aa-4aa7-97c4-15294eae187f.png#averageHue=%23f9f7ee&id=kp5TG&originHeight=955&originWidth=1340&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)
8. [http://218.201.228.158:9280/](http://218.201.228.158:9280/)
![](https://cdn.nlark.com/yuque/0/2023/png/36030634/1700139281131-b7d80ebd-24a2-4d09-9d69-a2679435da30.png#averageHue=%23f8f6ee&id=nbhgy&originHeight=951&originWidth=1217&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)
9. [http://8.136.182.98:8001/](http://8.136.182.98:8001/)
![](https://cdn.nlark.com/yuque/0/2023/png/36030634/1700139281561-7caddb2c-7f3f-4353-a452-443508438e14.png#averageHue=%23e6cf36&id=Wp0JT&originHeight=978&originWidth=1009&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)
10. [http://arcgis.service.shuikuguanjia.com:9280/](http://arcgis.service.shuikuguanjia.com:9280/)
![](https://cdn.nlark.com/yuque/0/2023/png/36030634/1700139281939-36a394ec-9399-4fd6-9dcf-70a03f034b58.png#averageHue=%23f8f7ee&id=TX2Oa&originHeight=969&originWidth=1235&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)

